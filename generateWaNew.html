<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WhatsApp Generator</title>

<style>
*{box-sizing:border-box}

body{
  margin:0;
  padding:0;
  background:linear-gradient(135deg,#f1f5f9,#e2e8f0);
  font-family:Inter,system-ui,-apple-system,sans-serif;
  color:#0f172a;
}

.container{
  max-width:420px;
  margin:40px auto;
  background:#ffffff;
  border-radius:16px;
  box-shadow:0 10px 30px rgba(15,23,42,0.12);
  padding:22px;
}

/* Tabs */
.tabs{
  display:flex;
  background:#f1f5f9;
  border-radius:12px;
  padding:4px;
  margin-bottom:18px;
}

.tab-btn{
  flex:1;
  padding:8px;
  border:none;
  background:transparent;
  font-weight:600;
  cursor:pointer;
  border-radius:8px;
}

.tab-btn.active{
  background:#ffffff;
  box-shadow:0 2px 8px rgba(0,0,0,0.08);
}

/* Form */
.field{margin-bottom:14px}
.field label{
  font-size:13px;
  font-weight:600;
  display:block;
  margin-bottom:6px;
}
.field input,
.field textarea{
  width:100%;
  border:1px solid #cbd5f5;
  border-radius:10px;
  padding:10px 12px;
  font-size:14px;
  outline:none;
}
.field textarea{min-height:90px;resize:none}

.helper{
  font-size:12px;
  color:#64748b;
  margin-top:4px;
}

.button{
  width:100%;
  margin-top:14px;
  background:linear-gradient(135deg,#22c55e,#16a34a);
  color:#fff;
  border:none;
  border-radius:12px;
  padding:12px;
  font-size:15px;
  font-weight:700;
  cursor:pointer;
}

.button.secondary{
  background:#0f172a;
}

.result{
  margin-top:16px;
  background:#f8fafc;
  border-radius:12px;
  padding:12px;
  font-size:13px;
  border:1px dashed #cbd5f5;
  word-break:break-all;
}

.result a{
  color:#16a34a;
  text-decoration:none;
  font-weight:600;
}

.preview-box{
  background:#f8fafc;
  padding:14px;
  border-radius:12px;
  font-size:14px;
  border:1px solid #e2e8f0;
  white-space:pre-wrap;
}

.hidden{display:none}
</style>
</head>

<body>

<div class="container">

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab-btn active" onclick="switchTab('form')">Form</button>
    <button class="tab-btn" onclick="switchTab('preview')">Preview</button>
  </div>

  <!-- FORM TAB -->
  <div id="formTab">
    <div class="field">
      <label>Nomor WhatsApp</label>
      <input type="text" id="waNumber" placeholder="628123456789">
    </div>

    <div class="field">
      <label>Nama Produk</label>
      <input type="text" id="productName" placeholder="iPhone 15 Pro">
    </div>

    <div class="field">
      <label>Pesan</label>
      <textarea id="waMessage"></textarea>
      <div class="helper">
        Gunakan <b>{{nama_produk}}</b> untuk posisi nama produk (bebas di mana saja)
      </div>
    </div>

    <button class="button" onclick="generateLink()">Generate Link</button>

    <div class="result hidden" id="resultBox">
      <div>Link WhatsApp:</div>
      <a id="waLink" href="#" target="_blank"></a>
      <button class="button secondary" onclick="copyLink()">Copy Link</button>
    </div>
  </div>

  <!-- PREVIEW TAB -->
  <div id="previewTab" class="hidden">
    <div class="preview-box" id="previewMessage"></div>
    <button class="button" id="previewButton">
      Buka WhatsApp
    </button>
  </div>

</div>

<script>
const DEFAULT_NUMBER = "6282119227871";
const DEFAULT_PRODUCT = "iPhone";
const DEFAULT_MESSAGE = "Saya tertarik untuk kredit {{nama_produk}} di Topsell Bhayangkara";

const numberInput = document.getElementById('waNumber');
const productInput = document.getElementById('productName');
const messageInput = document.getElementById('waMessage');

const resultBox = document.getElementById('resultBox');
const waLink = document.getElementById('waLink');
const previewMessage = document.getElementById('previewMessage');
const previewButton = document.getElementById('previewButton');

/* Load storage / default */
numberInput.value = localStorage.getItem('wa_number') || DEFAULT_NUMBER;
productInput.value = localStorage.getItem('wa_product') || DEFAULT_PRODUCT;
messageInput.value = localStorage.getItem('wa_message') || DEFAULT_MESSAGE;

/* Auto save */
[numberInput, productInput, messageInput].forEach(el=>{
  el.addEventListener('input', ()=>{
    localStorage.setItem('wa_number', numberInput.value);
    localStorage.setItem('wa_product', productInput.value);
    localStorage.setItem('wa_message', messageInput.value);
  });
});

/* Generate Link */
function generateLink(){
  let number = numberInput.value.trim() || DEFAULT_NUMBER;
  let product = productInput.value.trim() || DEFAULT_PRODUCT;
  let messageTemplate = messageInput.value.trim() || DEFAULT_MESSAGE;

  number = number.replace(/[^0-9]/g,'');

  const finalMessage = messageTemplate.replaceAll('{{nama_produk}}', product);
  const encodedMessage = encodeURIComponent(finalMessage);

  const link = `https://wa.me/${number}?text=${encodedMessage}`;

  waLink.href = link;
  waLink.textContent = link;
  resultBox.classList.remove('hidden');

  previewMessage.textContent = finalMessage;
  previewButton.onclick = () => window.open(link, '_blank');

  localStorage.setItem('wa_number', number);
  localStorage.setItem('wa_product', product);
  localStorage.setItem('wa_message', messageTemplate);
}

/* Copy link */
function copyLink(){
  navigator.clipboard.writeText(waLink.href);
  alert("Link berhasil disalin!");
}

/* Tabs */
function switchTab(tab){
  document.getElementById('formTab').classList.add('hidden');
  document.getElementById('previewTab').classList.add('hidden');
  document.querySelectorAll('.tab-btn').forEach(btn=>btn.classList.remove('active'));

  if(tab==='form'){
    document.getElementById('formTab').classList.remove('hidden');
    document.querySelectorAll('.tab-btn')[0].classList.add('active');
  }else{
    document.getElementById('previewTab').classList.remove('hidden');
    document.querySelectorAll('.tab-btn')[1].classList.add('active');
    generateLink();
  }
}
</script>

</body>
</html>
